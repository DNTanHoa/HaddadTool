(globalThis.webpackChunkphoto8=globalThis.webpackChunkphoto8||[]).push([[940],{16251:()=>{},29800:()=>{},36073:(e,t,a)=>{"use strict";a.d(t,{$b:()=>c,ku:()=>i,o6:()=>m,x6:()=>d});var l=a(72450),n=a.n(l),r=a(40854),o=a.n(r),s=a(62911);a(73936);function c(e,t="",a=512){const l=atob(e),n=[];for(let r=0;r<l.length;r+=a){const e=l.slice(r,r+a),t=new Array(e.length);for(let a=0;a<e.length;a+=1)t[a]=e.charCodeAt(a);const o=new Uint8Array(t);n.push(o)}return new Blob(n,{type:t})}function i(e){return e instanceof Blob?new Promise(t=>{const a=new FileReader;a.onload=()=>{t(function(e){let t="";const a=new Uint8Array(e),l=a.byteLength;for(let n=0;n<l;n+=1)t+=String.fromCharCode(a[n]);return window.btoa(t)}(a.result))},a.readAsArrayBuffer(e)}):null}const m=(e,t,a)=>{const l=c(t,s.pt.getMimeType(a));n().saveAs(l,`${e}.${s.pt.getExtension(a)}`)},d=e=>new Promise(async(t,a)=>{try{const a=await o().get(e,{responseType:"application/pdf"});t({src:`data:application/pdf;base64,${a.data}#toolbar=0`})}catch(l){a(l)}})},36359:(e,t,a)=>{"use strict";a.r(t),a.d(t,{exportToExcel:()=>v,fetchHistory:()=>h,fetchItems:()=>p});var l=a(40854),n=a.n(l),r=a(18527),o=a(86883),s=a(84573),c=a(47515),i=a(23133),m=a(73936),d=a(36073),u=a(62911);const p=(e,t,a)=>async l=>{try{const s=(0,r.v4)();l({type:o.QY,payload:{fetchId:s,pageParams:e,sortParams:t,filterParams:a}});const d=await n().post(`${m.U.backendUrl}/Requests/Search`,{...e,...(0,c.Wl)(t),...(0,i.Y)(a)});if(200===d.data.Code)return l({type:o.a4,payload:{fetchId:s,items:d.data.Result.Items,total:d.data.Result.Total}})}catch(d){return l({type:o.Px}),(0,s.s)(l,res.data.Error)}},v=(e,t)=>async()=>{try{const a=await n().post(`${m.U.backendUrl}/Requests/ExportToExcel`,{...(0,c.Wl)(e),...(0,i.Y)(t)});if(200===a.data.Code)return(0,d.o6)(a.data.Result.Name,a.data.Result.Content,u.pt.XLSX);throw new Error(a.data.Error)}catch(a){throw a}},h=e=>async t=>{try{t({type:o.oo});const a=await n().post(`${m.U.backendUrl}/Requests/${e}/History`);if(200===a.data.Code)return t({type:o.EL}),a.data.Result}catch(a){throw t({type:o.Hf}),a}}},41644:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var l=a(65043),n=a(66313),r=a.n(n),o=a(72287),s=a(36932),c=a(35772);const i=({show:e,children:t,confirmationLabel:a,declineLabel:n,inProgress:i,handleToggle:m,handleConfirmation:d,disableBackdrop:u})=>l.createElement(o.A,{show:e,onHide:()=>u?null:m(),className:"modal-default"},l.createElement(r().Body,{className:"confirmation-modal"},l.createElement(s.A,{glyph:"icon-error",width:40,height:40}),t),l.createElement(r().Footer,null,l.createElement(c.A,{type:"default",onClick:m},n),l.createElement(c.A,{inProgress:i,type:"primary",onClick:d},a)));i.defaultProps={disableBackdrop:!1,declineLabel:"Cancel",inProgress:!1};const m=i},45012:(e,t,a)=>{"use strict";a.d(t,{Y:()=>l});const l=(e,t)=>e?[e.FirstName,e.LastName].join(" "):t},62911:(e,t,a)=>{"use strict";a.d(t,{pt:()=>n});const l=JSON.parse('{"pdf":"application/pdf","ppt":"application/vnd.ms-powerpoint","xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}'),n={PDF:"PDF",PPT:"PPTX",XLSX:"XLSX",getExtension:e=>e.toLowerCase(),getMimeType:e=>l[e]}},66784:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>vt});var l={};a.r(l),a.d(l,{addAttachments:()=>Y,addComment:()=>J,changeStatus:()=>Q,clearCurrentRequest:()=>G,deleteAttachment:()=>j,deleteComment:()=>K,deleteItem:()=>z,downloadAsPdf:()=>ae,fetchItem:()=>B,saveCarton:()=>_,setQuantityPerCarton:()=>te,setUnitSystem:()=>ee,updateComment:()=>Z,updateGroupComment:()=>X,updateItem:()=>M,updateSoForm:()=>O});var n=a(65043),r=a(97508),o=a(77048),s=a(36296),c=a(91688),i=a(62582);const m=({children:e})=>n.createElement("div",{className:"tab-bar-view"},n.createElement("div",{className:"tab-bar-nav"},e),n.createElement("div",{className:"tab-bar-right-border"})),d=({children:e})=>n.createElement("div",{className:"content"},e);var u=a(53536);const p=e=>e.children,v=({redirectToFirstTab:e,children:t})=>e?n.createElement(c.rd,{to:(0,u.isArray)(t)?t[0].props.path:t.props.path}):n.createElement("div",{className:"tabview-content"},n.createElement(m,null,n.Children.map(t,({props:e})=>n.createElement(i.k2,{to:e.path},e.label))),n.createElement(d,null,n.createElement(c.dO,null,n.Children.map(t,e=>n.createElement(c.qh,{path:e.props.path},e)))));var h=a(90765),E=a(21645),y=a(75787),f=a(11181),g=a(71719),b=a(24168),C=a(92127),w=a(40545),N=a(42065),S=a(6297),A=a(35772),P=a(41644),I=a(90441),F=a(43086),k=a(98139),U=a.n(k);const $=({label:e,selected:t=!1})=>n.createElement("div",{className:U()({[`status-btn ${e.toLowerCase()}`]:!0,selected:t})},e);var D=a(36359),q=a(40854),T=a.n(q),R=a(72450),x=a.n(R),L=a(75058),W=a(73936),V=a(22129),H=a(53420);const G=()=>e=>e({type:H.WX}),B=e=>async t=>{t({type:H.fF});const a=await T().get(`${W.U.backendUrl}/Requests/${e}`);return 200===a.data.Code?t({type:H.x1,payload:{item:a.data.Result}}):t({type:H.Cr})},M=(e,t)=>async a=>{try{a({type:H.c9});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/Update`,t);if(200===l.data.Code)return a({type:H.Qk,payload:{request:l.data.Result}}),{status:"ok"};if(205===l.data.Code)return a({type:H.$y}),{status:"duplicate"};throw new Error(l.data.Error)}catch(l){return a((0,L.error)((0,V.A)(l.message))),a({type:H.$y})}},z=e=>async t=>{try{t({type:H.Yw});const a=await T().post(`${W.U.backendUrl}/Requests/${e}/Delete`);if(200===a.data.Code)return t({type:H.CE});throw new Error(a.data.Error)}catch(a){throw t({type:H.dW}),a}},Q=(e,t)=>async a=>{try{a({type:H.y9});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/ChangeStatus?statusId=${t}`);if(200===l.data.Code)return a({type:H.im,payload:{status:l.data.Result}});throw new Error(l.data.Error)}catch(l){throw a({type:H.xI}),l}},O=(e,t)=>async a=>{try{a({type:H.KI});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/SoForm/Update`,t);if(200===l.data.Code)return a({type:H.MO,payload:{request:l.data.Result}});throw new Error(l.data.Error)}catch(l){return a((0,L.error)((0,V.A)(l.message))),a({type:H.T8})}},_=(e,t)=>async a=>{try{a({type:H.w3,payload:{carton:t}});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/Carton/Save`,t);if(200===l.data.Code)return a({type:H.M4,payload:{cartons:l.data.Result}});throw new Error(l.data.Error)}catch(l){return a((0,L.error)((0,V.A)(l.message))),a({type:H.V5})}},Y=(e,t,a,l)=>async n=>{try{n({type:H.JX});const r=await T().post(`${W.U.backendUrl}/Requests/${t}/${a}/${l}/AddAttachments`,e);if(200===r.data.Code)return n({type:H.fz,payload:{groupTypeName:a,groupId:l,attachments:r.data.Result}});throw new Error(r.data.Error)}catch(r){return n((0,L.error)((0,V.A)(r.message))),n({type:H.i2})}},j=(e,t,a,l)=>async n=>{try{n({type:H.qy});const r=await T().get(`${W.U.backendUrl}/Requests/${e}/${t}/${a}/Attachment/${l}/Delete`);if(200===r.data.Code)return n({type:H.QQ,payload:{groupTypeName:t,groupId:a,attachmentId:l}});throw new Error(r.data.Error)}catch(r){return n((0,L.error)((0,V.A)(r.message))),n({type:H.Te})}},X=(e,t,a,l)=>async n=>{try{n({type:H.iA});const r=await T().post(`${W.U.backendUrl}/Requests/${t}/${a}/${l}/UpdateComment`,e);if(200===r.data.Code)return n({type:H.GV,payload:{groupTypeName:a,groupId:l,comment:r.data.Result}});throw new Error(r.data.Error)}catch(r){return n((0,L.error)((0,V.A)(r.message))),n({type:H.Jb})}},J=(e,t)=>async a=>{try{a({type:H.OG});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/Comment/Add`,t);if(200===l.data.Code)return a({type:H.ep,payload:{comments:l.data.Result}});throw new Error(l.data.Error)}catch(l){return a((0,L.error)((0,V.A)(l.message))),a({type:H.lt})}},Z=(e,t,a)=>async l=>{try{l({type:H.yi});const n=await T().post(`${W.U.backendUrl}/Requests/${e}/Comment/${t}/Update`,a);if(200===n.data.Code)return l({type:H.Q2,payload:{comments:n.data.Result}});throw new Error(n.data.Error)}catch(n){return l((0,L.error)((0,V.A)(n.message))),l({type:H.Bl})}},K=(e,t)=>async a=>{try{a({type:H.AY});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/Comment/${t}/Delete`);if(200===l.data.Code)return a({type:H.eQ,payload:{commentId:t}});throw new Error(l.data.Error)}catch(l){return a((0,L.error)((0,V.A)(l.message))),a({type:H.rt})}},ee=(e,t)=>async a=>{try{a({type:H.oz});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/SetUnitSystem?unitSystemId=${t}`);if(200===l.data.Code)return a({type:H.WF,payload:{unitSystem:l.data.Result}});throw new Error(l.data.Error)}catch(l){throw a({type:H.xB}),l}},te=(e,t)=>async a=>{try{a({type:H.dV});const l=await T().post(`${W.U.backendUrl}/Requests/${e}/SetQuantityPerCarton?quantityPerCarton=${t}`);if(200===l.data.Code)return a({type:H.dI,payload:{quantityPerCarton:l.data.Result}});throw new Error(l.data.Error)}catch(l){throw a({type:H.Ud}),l}},ae=(e,t)=>async()=>{const a=await T().get(`${W.U.backendUrl}/Pdf/ExportToPdf?requestId=${e}`,{responseType:"blob"});if(200===a.status)return x().saveAs(a.data,t);throw new Error("Error during download PDF")},le=(e,t)=>{var a,l,n,r;return!!t&&(null!==(a=e.settings)&&void 0!==a&&a["vendor-permission"]?e.userRoles.some(e=>["NY_APPROVER","HBE_APPROVER"].includes(e))&&(null===(n=e.vendorCodes)||void 0===n?void 0:n.includes(null===(r=t.Factory)||void 0===r?void 0:r.VendorCode)):null===e||void 0===e||null===(l=e.userRoles)||void 0===l?void 0:l.some(e=>W.U.canApprove[e]===t.Type))},ne=(0,r.connect)(({requestDetails:e,dictionaries:t,user:a})=>({isFetching:e.isFetching,request:e.request,canApproveByApprover:le(a,null===e||void 0===e?void 0:e.request),currentUserName:a.id,dictionaries:t}),e=>({requestDetailsActions:(0,o.bindActionCreators)(l,e),requestsActions:(0,o.bindActionCreators)(D,e)}))(({isFetching:e,request:t,dictionaries:a,canApproveByApprover:l,currentUserName:r,requestDetailsActions:o,requestsActions:s,onSave:i})=>{var m,d,u,p,v,h,E;const[y,f]=(0,n.useState)(!1),[k,U]=(0,n.useState)(!1),D=(0,c.W6)(),{showError:q,showSuccess:T}=(0,S.d)(),{isReadonly:R,isAdmin:x,isApprover:L,canDeleteAllRequests:W}=(0,g.A)(),V=null===t||void 0===t||null===(m=t.ShipDates)||void 0===m?void 0:m.some(e=>(0,b.isBefore)(new Date,e)),[H,G]=(0,n.useState)(!1);(0,n.useEffect)(()=>{null!==t&&void 0!==t&&t.Id&&(async()=>{try{var e;const a=(await s.fetchHistory(null===t||void 0===t?void 0:t.Id)).find(e=>{var t,a;return"CHANGE_STATUS"===(null===e||void 0===e||null===(t=e.EventType)||void 0===t?void 0:t.Code)&&"correction needed"===(null===e||void 0===e||null===(a=e.NewValue)||void 0===a?void 0:a.toLowerCase())});G("correction needed"===(null===t||void 0===t||null===(e=t.Status)||void 0===e?void 0:e.Name.toLowerCase())&&(null===a||void 0===a?void 0:a.ModifyBy)===r)}catch(a){q(a)}})()},[t]);const B=!R&&!x&&!L&&V&&"draft"===(null===t||void 0===t||null===(d=t.Status)||void 0===d?void 0:d.Name.toLowerCase()),M=!R&&!x&&!L&&["draft","correction needed"].includes(null===t||void 0===t||null===(u=t.Status)||void 0===u?void 0:u.Name.toLowerCase()),z=!R&&(x||l)&&!(null===t||void 0===t||!t.SoFormId)&&"approval needed"===(null===t||void 0===t||null===(p=t.Status)||void 0===p?void 0:p.Name.toLowerCase()),Q=!R&&(x||l)&&!(null===t||void 0===t||!t.SoFormId)&&("approval needed"===(null===t||void 0===t||null===(v=t.Status)||void 0===v?void 0:v.Name.toLowerCase())||H),O=W||V&&x&&"approved"!==(null===t||void 0===t||null===(h=t.Status)||void 0===h?void 0:h.Name.toLowerCase())||r===(null===t||void 0===t?void 0:t.CreatedBy)&&"draft"===(null===t||void 0===t||null===(E=t.Status)||void 0===E?void 0:E.Name.toLowerCase()),_=()=>D.push("/Requests"),Y=async()=>{try{f(!1),await o.deleteItem(t.Id),_(),T("Request deleted successfully!")}catch(e){q(e)}},[j,X]=(0,n.useState)(!1),J=async()=>{try{X(!0),await o.downloadAsPdf(t.Id,`${t.Id}_${t.Name.split(" ").join("_")}.pdf`)}catch(e){q(e)}finally{X(!1)}};return n.createElement(F.A,null,({findStatusId:l})=>{var r;const s=async e=>{await i(),o.changeStatus(t.Id,l(e))};return n.createElement(N.A,{className:"request-details-header",userInfoClassName:"header-user-info__small",small:!0},n.createElement(w.Ay,{isVisible:!0},!e&&!!t&&n.createElement(n.Fragment,null,n.createElement(w.In,null,n.createElement("div",{className:"back"},n.createElement(A.A,{onClick:_},n.createElement(C.g,{icon:["fas","play"]}))),n.createElement("div",{className:"title-toolbar"},n.createElement("p",{className:"default-header__title"},t.Name),n.createElement("div",{className:"toolbar"},n.createElement(A.A,{type:"primary",inProgress:j,curtain:!0,spinnerSize:20,onClick:J},"Download as PDF"),B&&n.createElement(A.A,{type:"primary",onClick:()=>s("draft")},"Save Draft"),M&&n.createElement(A.A,{className:"btn-orange",onClick:()=>null!==t&&void 0!==t&&t.SoFormId?s("approval needed"):U(!0)},"Send for Approval Needed"),z&&n.createElement(A.A,{type:"danger",onClick:()=>s("correction needed")},"Need Correction"),Q&&n.createElement(A.A,{className:"btn-green",onClick:()=>s("approved")},"Approve"),O&&n.createElement(A.A,{type:"danger",onClick:()=>f(!0)},"Delete")))),n.createElement(w.fV,null,null===(r=a.statuses)||void 0===r?void 0:r.map(e=>{var a;return n.createElement($,{key:e.Id,label:e.Name,selected:(null===t||void 0===t||null===(a=t.Status)||void 0===a?void 0:a.Id)===e.Id})})))),n.createElement(P.A,{show:y,confirmationLabel:"Yes",declineLabel:"No",handleToggle:()=>f(!1),handleConfirmation:Y},n.createElement("span",{className:"text-center"},"Are you sure to delete this request ?")),n.createElement(I.A,{show:k,icon:"icon-error",handleToggle:()=>U(!1)},"Hey! You have\u2019t selected  the SO Form yet!"))})});var re=a(38591),oe=a(68117),se=a(73383),ce=a(56329),ie=a(18182);const me={imperial:{length:"''",weight:"lbs"},metric:{length:"cm",weight:"kg"}},de=n.forwardRef(({page:e,request:t,disabled:a,unitSystems:l,onSave:r,onSetUnitSystem:o,onSetQuantityPerCarton:s},c)=>{var i;const m=e=>e.Length||e.Width||e.Height||e.NetWeight||e.GrossWeight,d=e=>{r(t.Id,e.Cartons.filter(m).map(e=>({Id:e.Id,Po:e.Po,Length:parseFloat(e.Length),Width:parseFloat(e.Width),Height:parseFloat(e.Height),NetWeight:parseFloat(e.NetWeight),GrossWeight:parseFloat(e.GrossWeight),Comment:e.Comment})))},{values:u,setValues:p,setFieldValue:v,isEdited:h}=(0,ie.m)({onSubmit:d}),[E,y]=(0,n.useState)(""),f=(e,t)=>{const a=u.Cartons.findIndex(t=>t.Po===e);v("Cartons",[...u.Cartons.slice(0,a),{...u.Cartons[a],...t},...u.Cartons.slice(a+1)])};return(0,n.useEffect)(()=>{y((null===t||void 0===t?void 0:t.QuantityPerCarton)||"");const e=t.Cartons.reduce((e,t)=>({...e,[t.Po]:t}),{}),a=t.AllPos.map(e=>e.Po).sort();p({Cartons:a.map(t=>{const a=e[t];return a?{Id:a.Id,Po:a.Po,Length:a.Length||"",Width:a.Width||"",Height:a.Height||"",NetWeight:a.NetWeight||"",GrossWeight:a.GrossWeight||"",Comment:a.Comment}:{Po:t,Length:"",Width:"",Height:"",NetWeight:"",GrossWeight:"",Comment:""}})})},[t]),n.createElement("div",{className:"cartons"},n.createElement(se.A,{ref:c,mainPath:e,values:u,isEdited:h(),canSave:(()=>{var e;return null===(e=u.Cartons)||void 0===e?void 0:e.some(m)})(),onSave:d},n.createElement(re.A,{row:!0},n.createElement(re.D,{name:"Units"},n.createElement(ce.A,{disabled:a,data:l,value:t.UnitSystem,valueField:"Id",textField:"Name",onChange:e=>o(t.Id,e.Id)})),n.createElement(re.D,{name:"Qty per Carton"},n.createElement("input",{type:"number",disabled:a,value:E,min:1,onChange:e=>y(e.target.valueAsNumber),onBlur:()=>{E&&!isNaN(E)&&parseInt(E,10)!==t.QuantityPerCarton&&s(t.Id,E)}}))),null===(i=u.Cartons)||void 0===i?void 0:i.map(e=>{var a,l,r,o,s,c,i,m,d,u,p,v,h,E,y;return n.createElement("div",{key:e.Po,className:"carton"},n.createElement("div",{className:"po-number"},e.Po),n.createElement("form",null,n.createElement("div",{className:"column"},n.createElement(re.A,null,n.createElement(re.D,{name:"Length"},n.createElement(oe.A,{value:e.Length,onChange:t=>f(e.Po,{Length:t}),unit:null===(a=me[null===t||void 0===t||null===(l=t.UnitSystem)||void 0===l||null===(r=l.Name)||void 0===r?void 0:r.toLowerCase()])||void 0===a?void 0:a.length})),n.createElement(re.D,{name:"Width"},n.createElement(oe.A,{value:e.Width,onChange:t=>f(e.Po,{Width:t}),unit:null===(o=me[null===t||void 0===t||null===(s=t.UnitSystem)||void 0===s||null===(c=s.Name)||void 0===c?void 0:c.toLowerCase()])||void 0===o?void 0:o.length})),n.createElement(re.D,{name:"Height"},n.createElement(oe.A,{value:e.Height,onChange:t=>f(e.Po,{Height:t}),unit:null===(i=me[null===t||void 0===t||null===(m=t.UnitSystem)||void 0===m||null===(d=m.Name)||void 0===d?void 0:d.toLowerCase()])||void 0===i?void 0:i.length})),n.createElement(re.D,{name:"Net Weight"},n.createElement(oe.A,{value:e.NetWeight,onChange:t=>f(e.Po,{NetWeight:t}),unit:null===(u=me[null===t||void 0===t||null===(p=t.UnitSystem)||void 0===p||null===(v=p.Name)||void 0===v?void 0:v.toLowerCase()])||void 0===u?void 0:u.weight})),n.createElement(re.D,{name:"Gross Weight"},n.createElement(oe.A,{value:e.GrossWeight,onChange:t=>f(e.Po,{GrossWeight:t}),unit:null===(h=me[null===t||void 0===t||null===(E=t.UnitSystem)||void 0===E||null===(y=E.Name)||void 0===y?void 0:y.toLowerCase()])||void 0===h?void 0:h.weight})))),n.createElement("div",{className:"column"},n.createElement(re.A,null,n.createElement(re.D,{name:"Comment",box:!0},n.createElement("textarea",{value:e.Comment,onChange:t=>f(e.Po,{Comment:t.target.value})})))),n.createElement("div",{className:"column"})))})))});var ue=a(36073),pe=a(72287),ve=a(66313),he=a.n(ve),Ee=a(36932);const ye=({title:e,handleToggle:t})=>n.createElement(he().Header,null,n.createElement("h1",{className:"modal-header__heading"},e),n.createElement("button",{type:"button",onClick:t,className:"modal-header__btn"},n.createElement(Ee.A,{glyph:"icon-close",width:12,height:12})));ye.defaultProps={title:""};const fe=ye;var ge=a(21525),be=a.n(ge);const Ce=({children:e})=>n.createElement(be(),{className:"modal-main-content"},e);var we=a(52295),Ne=a(55481);const Se=({onDrop:e,accept:t,disabled:a,text1:l,text2:r})=>n.createElement(Ne.A,{className:"file-input",activeClassName:"file-input--active",onDrop:e,disabled:a,accept:t},n.createElement("span",null,n.createElement("strong",null,l)," ",n.createElement("br",null),r));Se.defaultProps={disabled:!1,accept:null,text1:"Drop file to attach",text2:"or select file"};const Ae=Se,Pe=({children:e,name:t,onClick:a})=>n.createElement("button",{className:"btn btn-default file-name-button",name:t,onClick:a,type:"button"},e,n.createElement(Ee.A,{glyph:"icon-clear",width:"13px",height:"13px"})),Ie=({label:e,files:t,inProgress:a,handleDrop:l,handleRemove:r,accept:o})=>n.createElement("div",{className:"modal-file-section"},n.createElement("div",{className:"modal-file-section__main"},!!e&&n.createElement("span",{className:"modal-file-section__label"},e),n.createElement(Ae,{onDrop:l,accept:o}),n.createElement(s.A,{isVisible:a,size:100})),n.createElement("div",{className:"files"},t.map((e,t)=>n.createElement(Pe,{key:t,name:t,onClick:()=>r(t)},e.name)))),Fe=({title:e="Upload file",isVisible:t,isImporting:a=!1,onSubmit:l,hide:r,labelProceed:o="Upload",accept:s})=>{const[c,i]=(0,n.useState)([]),[m,d]=(0,n.useState)(!1),u=()=>{i([]),r()};return n.createElement(n.Fragment,null,n.createElement(pe.A,{show:t,onHide:u,className:"upload-file-modal"},n.createElement(fe,{title:e,handleToggle:()=>{u()}}),n.createElement(Ce,null,n.createElement(re.A,null,n.createElement(Ie,{files:c,inProgress:m,accept:s,handleDrop:async e=>{try{d(!0);const t=await Promise.all(e.map(e=>(0,ue.ku)(e))),a=[];for(let l=0;l<e.length;l++)a.push({name:e[l].name,type:e[l].type,content:t[l]});i(e=>[...e,...a])}catch(t){console.error(t)}finally{d(!1)}},handleRemove:e=>{i(t=>{const a=t[e];return t.filter(e=>e.name!==a.name)})}}))),n.createElement(we.A,{labelProceed:o,handleCancel:u,handleProceed:()=>{l(c),i([])},inProgress:a,isProceedDisabled:!c.length})))};var ke=a(44238);const Ue=({isVisible:e,size:t=200})=>e?n.createElement("div",{className:"spinner-wrapper"},n.createElement(ke.A,{size:t,isVisible:!0})):null,$e=({show:e})=>e?n.createElement("div",{className:"error-message"},n.createElement("p",{className:"alert"},"Unable to load/preview file")):null,De=({fileName:e,filePath:t,spinnerSize:a})=>{const[l,r]=(0,n.useState)(null),[o,s]=(0,n.useState)(!1),[c,i]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{(async()=>{try{if(i(!1),s(!0),t.startsWith("blob:"))return r(`${t}#toolbar=0&navpanes=0`),void s(!1);const e=await(0,ue.x6)(t);r(e.src),s(!1)}catch{s(!1),i(!0)}})()},[t,e]),n.createElement(n.Fragment,null,n.createElement("div",{className:U()({"preview-content":!0,pdf:!0})},!o&&!c&&l&&n.createElement("iframe",{width:"100%",height:"100%",src:l}),n.createElement(Ue,{isVisible:o,size:a}),n.createElement($e,{show:c})))},qe=({src:e,name:t})=>n.createElement("div",{className:"pdf"},n.createElement(De,{filePath:e,fileName:t,spinnerSize:50}),n.createElement("div",{className:"clickable-area"})),Te=(e,t)=>`data:${t};base64, ${e}`,Re=({src:e,type:t,width:a,height:l})=>{const[r,o]=(0,n.useState)(null),[s,c]=(0,n.useState)(!1),[i,m]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{const a=new window.Image;c(!0),m(!1),null!==e&&void 0!==e&&e.startsWith("http")?a.src=e:a.src=Te(e,t),a.onload=()=>{o(a.src),c(!1)},a.onerror=()=>{c(!1),m(!0)}},[e]),n.createElement("div",{className:"image"},n.createElement(ke.A,{isVisible:s,size:50}),!s&&!i&&n.createElement(n.Fragment,null,n.createElement("img",{alt:"",src:r,width:a,height:l})),!s&&i&&n.createElement("div",{className:"error"},"Unable to load photo"))},xe=W.U.attachementFileTypes.filter(e=>"pdf"!==e),Le=({src:e,type:t,name:a,width:l=200,height:r=150,canDelete:o=!0,onClick:s,onDelete:c})=>n.createElement("div",{className:"tile"},n.createElement("div",null,n.createElement("div",{className:"content",style:{width:l,height:r},onClick:s},xe.includes(t)&&n.createElement(Re,{src:e,type:t,width:l,height:r}),"pdf"===t&&n.createElement(qe,{name:a,src:e}),["xls","xlsx"].includes(t)&&n.createElement(C.g,{className:"excel",icon:["far","file-excel"],size:"4x"}),o&&n.createElement("div",{className:"delete",onClick:e=>{e.stopPropagation(),c()}},n.createElement(C.g,{icon:["fas","times"]}))))),We=({show:e,hide:t,src:a,type:l})=>{const r=(0,n.useRef)(null),[o,s]=(0,n.useState)(null),[c,i]=(0,n.useState)({width:0,height:0}),m=()=>{if(r.current){const e=r.current.width/document.body.offsetWidth,t=r.current.height/document.body.offsetHeight,a=Math.max(t,e,1);i({width:r.current.width/a,height:r.current.height/a})}};return(0,n.useEffect)(()=>{if(!a)return;s(null);const e=new Image;return null!==a&&void 0!==a&&a.startsWith("http")?e.src=a:e.src=Te(a,l),e.onload=()=>{s(e),r.current=e,m()},window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}},[a]),e?n.createElement("div",{className:"modal-zoom",onClick:t},!o&&n.createElement(ke.A,{isVisible:!0,size:100}),o&&n.createElement("img",{alt:"",src:o.src,width:`${c.width}px`,height:`${c.height}px`})):null};var Ve=a(27030),He=a(85721);const Ge=({fileName:e,filePath:t})=>{const[a,l]=(0,n.useState)(null),[r,o]=(0,n.useState)(!1),[s,c]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{(async()=>{try{c(null),o(!0),l(null);const e=await T().get(t);l(e.data),o(!1)}catch{o(!1),c(!0)}})()},[t,e]),n.createElement("div",{className:"preview-content docx"},a&&(0,He.Ay)(a),n.createElement(Ue,{isVisible:r}),n.createElement($e,{show:s}))};var Be=a(81652),Me=a.n(Be),ze=a(38557),Qe=a.n(ze),Oe=a(83634),_e=a.n(Oe);class Ye extends n.Component{static parse(e){const t=[],a=[];return new(_e())(e).forEach(e=>{if(a.length<1)e.forEach((e,t)=>{a.push({key:`key-${t}`,name:e,resizable:!0,sortable:!0,filterable:!0})});else{const a={};e.forEach((e,t)=>{a[`key-${t}`]=e}),t.push(a)}}),{rows:t,columns:a}}constructor(e){super(e),this.state=Ye.parse(e.data)}componentWillReceiveProps(e){this.setState(Ye.parse(e.data))}render(){const{rows:e,columns:t}=this.state;return n.createElement(Qe(),{columns:t,rowsCount:e.length,rowGetter:t=>e[t],minHeight:this.props.height||650,onGridSort:()=>{}})}}const je=Ye,Xe=({fileName:e,filePath:t})=>{const[a,l]=(0,n.useState)(!1),[r,o]=(0,n.useState)(!1),[s,c]=(0,n.useState)([]),[i,m]=(0,n.useState)([]),[d,u]=(0,n.useState)(0),p=e=>{const t=new Uint8Array(e),a=[];for(let o=0;o!==t.length;o+=1)a.push(String.fromCharCode(t[o]));const l=Me().read(a.join(""),{type:"binary"}),n=Object.keys(l.Sheets),r=n.map(e=>Me().utils.sheet_to_csv(l.Sheets[e]));c(r),m(n),u(0)},v=async()=>{try{if(null===t||void 0===t||!t.startsWith("http")){const e=(0,ue.$b)(t),a=await e.arrayBuffer();return p(a)}(()=>{o(!1),l(!0);let e=new XMLHttpRequest;return"withCredentials"in e?(e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=()=>{if(l(!1),e.status>=400)return void o(!0);const t=e.response;p(t)},e):(e=null,null)})().send()}catch(e){throw o(!0),e}};return(0,n.useEffect)(()=>{v()},[t,e]),n.createElement("div",{className:"preview-content xlsx"},n.createElement(Ue,{isVisible:a}),s.length>0&&n.createElement(n.Fragment,null,n.createElement("div",{className:"sheet-names"},i.map((e,t)=>n.createElement("input",{key:e,type:"button",value:e,onClick:()=>u(t)}))),n.createElement(je,{data:s[d]})),n.createElement($e,{show:r}))},Je=()=>n.createElement("div",{className:"preview-content unsupported"},"Preview unsupported"),Ze=({fileName:e,type:t,filePath:a})=>{if(!a)return null;return n.createElement("div",{className:U()({preview:!0,[t]:!!t})},(()=>{switch(t){case"pdf":return n.createElement(De,{fileName:e,filePath:a});case"xls":case"xlsx":return n.createElement(Xe,{fileName:e,filePath:a});case"doc":case"docx":return n.createElement(Ge,{fileName:e,filePath:a});case null:case void 0:return n.createElement(n.Fragment,null);default:return n.createElement(Je,null)}})())},Ke=({show:e,hide:t,path:a,title:l,type:r})=>e?n.createElement(n.Fragment,null,n.createElement(pe.A,{show:e,onHide:t,className:"preview-modal"},n.createElement(Ve.A,{title:l,handleToggle:t}),n.createElement(Ce,null,n.createElement(Ze,{filePath:a,type:r})))):null,et=({value:e,onSave:t})=>{const[a,l]=(0,n.useState)("");(0,n.useEffect)(()=>{l(e||"")},[e]);return n.createElement("div",{className:"group-comment"},n.createElement(re.A,null,n.createElement(re.D,{name:"Comment",box:!0},n.createElement("textarea",{placeholder:"Put your comment here",value:a,onChange:e=>l(e.target.value),onBlur:()=>{a!==e&&t(a)}}))))},tt=({requestId:e,groupTypeName:t,group:a,onAdd:l,onDelete:r,onUpdateComment:o})=>{const{modalVisible:s,toggleModalVisible:c,resetModalVisible:i}=(0,f.A)(["add","image","pdf"]),[m,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{const e=e=>{"escape"===e.key.toLowerCase()&&i()};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[]);return n.createElement("div",{className:"attachments"},n.createElement("div",{className:"tiles",onClick:e=>{"tiles"===e.target.className&&c({add:!0})}},a&&a.Attachments.map(l=>({...l,Url:`${W.U.backendUrl}/Requests/${e}/${t}/${a.Id}/Attachment/${l.Id}`})).map(l=>n.createElement(Le,{key:l.Id,type:l.Type,name:l.Name,src:l.Url,onDelete:()=>r(e,t,a.Id,l.Id),onClick:()=>(e=>{d(e);const t="pdf"===e.Type?"pdf":"image";c({[t]:!0})})(l)}))),n.createElement(et,{value:a.Comment||"",onSave:l=>o({Comment:l},e,t,a.Id)}),n.createElement(Fe,{title:"Add Files",labelProceed:"Save",isVisible:s.add,accept:W.U.attachementFileTypes.map(e=>`.${e}`).join(","),onSubmit:n=>{l(n.map(e=>({Content:e.content,FileName:e.name})),e,t,a.Id),c({add:!1})},hide:()=>c({add:!1})}),n.createElement(We,{show:s.image,hide:()=>c({image:!1}),src:null===m||void 0===m?void 0:m.Url}),n.createElement(Ke,{show:s.pdf,hide:()=>c({pdf:!1}),path:null===m||void 0===m?void 0:m.Url,title:null===m||void 0===m?void 0:m.Name,type:"pdf"}))},at=({request:e,disabled:t,groupTypeName:a,onAddAttachments:l,onDeleteAttachment:r,onUpdateComment:o,children:s})=>{if(!e)return null;const c=1===e[a].length;return n.createElement("div",{className:U()({groups:!0,disabled:t})},s,e[a].map(t=>n.createElement("div",{className:U()({group:!0,single:c}),key:t.Id},!c&&n.createElement("div",{className:"group-name"},t.Name),n.createElement(tt,{requestId:e.Id,groupTypeName:a,group:t,onAdd:l,onDelete:r,onUpdateComment:o}))))},lt=e=>{var t;if(!e)return"";const a=e.split(".");return null===(t=a[a.length-1])||void 0===t?void 0:t.toLowerCase()},nt=n.forwardRef(({page:e,request:t,disabled:a,onSave:l},r)=>{const o=e=>{var t;l(e.RequestId,{SoFormId:null===(t=e.SoForm)||void 0===t?void 0:t.Id,Comment:{Value:e.Comment}})},{values:s,setValues:c,setFieldValue:i,isEdited:m}=(0,ie.m)({onSubmit:o});return(0,n.useEffect)(()=>{c({RequestId:null===t||void 0===t?void 0:t.Id,Comment:null===t||void 0===t?void 0:t.SoFormComment,SoForm:null===t||void 0===t?void 0:t.AvailableSoForms.find(e=>e.Id===t.SoFormId||e.IsDefault)})},[t]),n.createElement("div",{className:"so-form"},!!t&&!s.SoForm&&n.createElement(n.Fragment,null,!t.Customer&&n.createElement("div",{className:"warning"},"There is no customer connected to this request.",n.createElement("br",null),"Please select ",n.createElement("b",null,"Customer")," on ",n.createElement("b",null,"General Tab"),"."),!!t.Customer&&n.createElement("div",{className:"error"},"There is no So Form connected to selected account:"," ",n.createElement("b",null,t.Customer.Account),".",n.createElement("br",null),"Please contact with administrator.")),!!t&&!!s.SoForm&&n.createElement(se.A,{ref:r,mainPath:e,values:s,isEdited:m()||!t.SoFormId,canSave:!!s.SoForm,onSave:o},n.createElement("div",{className:"header"},n.createElement(ce.A,{disabled:a,data:(0,u.orderBy)(t.AvailableSoForms,"IsDefault","desc"),value:s.SoForm,valueField:"Id",textField:"File",itemComponent:({item:e})=>n.createElement("div",{className:U()({"so-form-dropdown-item":!0,default:e.IsDefault})},n.createElement("div",{className:"file"},e.File),n.createElement("div",{className:"type"},e.IsDefault?"Default":"Old")),onChange:e=>i("SoForm",e)})),n.createElement("div",{className:"form-content"},n.createElement(Ze,{fileName:null===s||void 0===s?void 0:s.SoForm.File,type:lt(null===s||void 0===s?void 0:s.SoForm.File),filePath:`${W.U.backendUrl}/SoForms/${null===s||void 0===s?void 0:s.SoForm.Id}/Get`}),n.createElement("div",{className:"comment"},n.createElement("div",{className:"comment-header"},n.createElement(C.g,{icon:["far","comment-alt"]}),n.createElement("div",null,"Comment")),n.createElement("textarea",{disabled:a,value:s.Comment,onChange:e=>i("Comment",e.target.value)})))))}),rt=({label:e,value:t,width:a,children:l})=>{const r=l||n.createElement(n.Fragment,null,t||n.createElement(n.Fragment,null,"\xa0"));return n.createElement("div",{className:"control-sheet-data-row"},n.createElement("div",{className:"control-sheet-data-row-label",style:{width:a}},e||n.createElement(n.Fragment,null,"\xa0")),n.createElement("div",{className:"control-sheet-data-row-value"},r))},ot=({request:e,onFetch:t})=>{var a,l,r,o;const[s,c]=(0,n.useState)(null),[i,m]=(0,n.useState)(null),{showError:d}=(0,S.d)();(0,n.useEffect)(()=>{e&&e.AllPos.length&&c(e.AllPos[0])},[e]),(0,n.useEffect)(()=>{s&&(async()=>{try{const e=await t(s.Po);m(e)}catch(e){d(e)}})()},[s]);const u=e=>i.RequiredHangerVendors.map(t=>n.createElement("div",{key:`${t.Id}_${e}`},t[e])),p=e=>n.createElement("div",{key:e.Id,className:"fabric-item"},n.createElement(rt,{label:"Garment Part",value:e.GarmentPart}),n.createElement(rt,{label:"Type",value:e.Type}),n.createElement(rt,{label:"Content",value:e.Content}),n.createElement(rt,{label:"WT/Const",value:e.WtConst}),n.createElement(rt,{label:"Max Shrinkage",value:e.MaxShrinkage}),n.createElement(rt,{label:"Wash",value:e.Wash}),n.createElement(rt,{label:"Spec#",value:e.Spec}));return e?n.createElement("div",{className:"control-sheet"},n.createElement("div",{className:"po-selector"},n.createElement("div",{className:"po-selector-label"},"Selected PO"),n.createElement(ce.A,{data:e.AllPos,textField:"Po",valueField:"Po",value:s,onChange:c})),i&&n.createElement("div",{className:"data"},n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},n.createElement(rt,{label:"UOM",value:i.UOM}),n.createElement(rt,{label:"PO#",value:i.PO}),n.createElement(rt,{label:"Season",value:i.Season}),n.createElement(rt,{label:"Ship Date",value:i.ShipDate}),n.createElement(rt,{label:"Division",value:i.Div}),n.createElement(rt,{label:"Style",value:i.Style}),n.createElement(rt,{label:"Color",value:i.Color}),n.createElement(rt,{label:"Label",value:i.Label}),n.createElement(rt,{label:"FashionColor",value:i.FashionColor}),n.createElement(rt,{label:"Reference#",value:i.Ref}),n.createElement(rt,{label:"Inner Pack Qty",value:i.InnerPackQty}),n.createElement(rt,{label:"Master Box Qty",value:i.MasterBoxQty}),n.createElement(rt,{label:"Size Rng",value:i.SizeRng}),n.createElement(rt,{label:"Brand",value:i.Brand}),n.createElement(rt,{label:"Prd.Class",value:i.PrdClass}),n.createElement(rt,{label:"Sub Brand",value:i.SubBrand}),n.createElement(rt,{label:"Gend/Size",value:i.GendSize}),n.createElement(rt,{label:"MSRP Code",value:i.MSRPCode}),n.createElement(rt,{label:"Hanging/Flat",value:i.HangingFlat})),n.createElement("div",{className:"column"},n.createElement(rt,{label:"Transaction Date",value:i.TransactionDate}),n.createElement(rt,{label:"",value:""}),n.createElement(rt,{label:"Office",value:i.Office}),n.createElement(rt,{label:"Country",value:i.Country}),n.createElement(rt,{label:"Manufacturer/Seller",value:i.Factory}),n.createElement(rt,{label:"Cost Type",value:i.CostType}),n.createElement(rt,{label:"Payment Type",value:i.PaymentType}),n.createElement(rt,{label:"LC/TT Days",value:i.LcTTDays}),n.createElement(rt,{label:"Air/Boat",value:i.AirBoat}),n.createElement(rt,{label:"ETA Port",value:i.EtaPort}),n.createElement(rt,{label:"ETD Port",value:i.EtdPort}),n.createElement(rt,{label:"Quantity",value:i.Quantity}),n.createElement(rt,{label:"Cost",value:i.Cost}),n.createElement(rt,{label:"PO Total $",value:i.PoTotal}),n.createElement(rt,{label:"Vendor Terms",value:i.VendorTerms}),n.createElement(rt,{label:"MSRP",value:i.MSRP}),n.createElement(rt,{label:"H/V%",value:i.HV}),n.createElement(rt,{label:"Freight Type",value:i.FreightType}),n.createElement(rt,{label:"Freight P/Dz",value:i.FreightPDz}))),n.createElement("div",{className:"fashion-correctable-info"},n.createElement("div",{className:"section-label"},"Fashion Correctable Info"),n.createElement(rt,{label:"Sticker",value:i.Sticker}),n.createElement(rt,{label:"Ticket",value:i.Ticket}),n.createElement(rt,{label:"Tck Price Walver",value:i.TckPriceWalver}),n.createElement(rt,{label:"Price",value:i.Price}),n.createElement(rt,{label:"Hanger"},n.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},n.createElement("div",null,i.Hanger),n.createElement("div",null,i.ExtraHanger),n.createElement(n.Fragment,null,"\xa0"))),n.createElement(rt,{label:"Size Strip",value:i.SizeStrip})),n.createElement("div",{className:"rows"},null===(a=i.HsRefs)||void 0===a?void 0:a.map(e=>n.createElement(n.Fragment,{key:e.HsRef},n.createElement("div",{className:"row"},n.createElement(rt,{label:"HS REF#",value:e.HsRef}),n.createElement(rt,{width:100,label:"%",value:e.Percentage}),n.createElement(rt,{width:500,label:"Description",value:e.Description}),n.createElement(rt,{width:150,label:"Duty",value:e.Duty}),n.createElement(rt,{width:150,label:"QTA",value:e.Qta}),n.createElement(rt,{width:150,label:"QTA CST",value:e.QtaCsts}))))),n.createElement("div",{className:"pack-ratio"},n.createElement("div",{className:"section-label"},"Pack Ratio"),n.createElement("div",{className:"rows"},n.createElement("div",{className:"row"},n.createElement(rt,{width:100,label:"Col",value:i.PackRatioColor}),n.createElement(rt,{width:100,label:"Lb",value:i.PackRatioLabel}),n.createElement(rt,{width:150,label:"Total",value:i.Total}),n.createElement(rt,{width:810,label:null===(l=i.PackSizes)||void 0===l?void 0:l.join(" "),value:null===(r=i.Packs)||void 0===r?void 0:r.join(" ")})))),(null===(o=i.RequiredHangerVendors)||void 0===o?void 0:o.length)>0&&n.createElement("div",{className:"pack-ratio"},n.createElement("div",{className:"section-label"},"Required Hanger Vendors"),n.createElement("div",{className:"rows"},n.createElement("div",{className:"row"},n.createElement(rt,{label:"Type"},u("Type")),n.createElement(rt,{label:"Vendor"},u("Vendor")),n.createElement(rt,{label:"Code"},u("Code")),n.createElement(rt,{label:"Color"},u("Color"))))),i.Comments.length>0&&n.createElement("div",{className:"comments"},n.createElement("div",{className:"section-label"},"Comments"),i.Comments.map(e=>n.createElement("div",{key:e,className:"comment"},e))),n.createElement("div",{className:"fabrics"},n.createElement("div",{className:"section-label"},i.Account),n.createElement("div",{className:"section-label"},"Fabrics"),n.createElement("div",{className:"columns"},n.createElement("div",{className:"column"},i.Fabrics.filter((e,t)=>t%2===0).map(e=>p(e))),n.createElement("div",{className:"column"},i.Fabrics.filter((e,t)=>t%2!==0).map(e=>p(e))))))):null};var st=a(18527);const ct=({acceptFiles:e=[],disabled:t,onSetFiles:a})=>{const[l,r]=(0,n.useState)(!1);return n.createElement("div",{className:"file-upload"},!t&&n.createElement(Ie,{files:[],accept:[...e,...W.U.attachementFileTypes].map(e=>`.${e}`).join(","),inProgress:l,handleDrop:async e=>{r(!0);const t=await Promise.all(e.map(e=>(0,ue.ku)(e)));r(!1);const l=t.map((a,l)=>({Id:(0,st.v4)(),Name:e[l].name,Type:lt(e[l].name),Content:t[l]})).map((a,l)=>({...a,Url:"pdf"===(null===a||void 0===a?void 0:a.Type)?e[l].preview:t[l]}));a(l)}}))};var it=a(45012);const mt=({acceptFiles:e,value:t,canEdit:a,onZoomAttachment:l,onSave:r,onDelete:o})=>{const[c,i]=(0,n.useState)(""),[m,d]=(0,n.useState)([]),[p,v]=(0,n.useState)(!1),h=!t.Id;(0,n.useEffect)(()=>{h?(i(""),d([])):(i(t.Value),d(t.Attachments))},[t]);return n.createElement("div",{className:"comment"},n.createElement(s.A,{isVisible:p,size:150}),n.createElement("div",{className:"comment-header"},n.createElement("div",{className:"date"},n.createElement(C.g,{icon:["fas","calendar-alt"]}),n.createElement("div",null,t.LastModifyDate?(0,b.format)(t.LastModifyDate,"MMM D, GGGG HH:mm"):"Now")),n.createElement("div",{className:"user"},a&&n.createElement("div",null,"by You"),!a&&n.createElement("div",null,"by ",(0,it.Y)(t.LastModifyByUser,t.LastModifyBy)),n.createElement("div",{className:"avatar"},n.createElement(C.g,{icon:["fas","user"]})))),n.createElement("div",{className:"comment-form"},n.createElement("div",{className:"comment-form-content"},n.createElement("textarea",{disabled:!h&&!a,value:c,onChange:e=>i(e.target.value)}),n.createElement("div",{className:"comment-form-attachments"},m.map(e=>n.createElement(Le,{key:e.Id,width:150,src:null===e||void 0===e?void 0:e.Url,type:null===e||void 0===e?void 0:e.Type,onClick:()=>l(e),canDelete:h||a,onDelete:()=>{return t=e.Id,void d(e=>e.filter(e=>e.Id!==t));var t}})),(h||a)&&n.createElement(ct,{acceptFiles:e,onSetFiles:e=>{d(t=>[...t,...e])}}))),n.createElement("div",{className:"comment-form-toolbar"},(h||a)&&n.createElement(A.A,{type:"primary",disabled:!c&&!m.length,onClick:e=>{e.target.blur(),(async()=>{try{v(!0),await r({Value:c,Attachments:m.map(e=>({Id:(0,u.isNumber)(e.Id)?e.Id:null,Content:e.Content,FileName:e.Name}))})}finally{v(!1)}})()}},"Save"),!h&&a&&n.createElement(A.A,{type:"danger",onClick:e=>{e.target.blur(),(async()=>{try{v(!0),await o()}finally{v(!1)}})()}},"delete"))))},dt=({request:e,userName:t,onAdd:a,onUpdate:l,onDelete:r})=>{const{modalVisible:o,toggleModalVisible:s}=(0,f.A)(["image","other"]),[c,i]=(0,n.useState)(null),[m]=(0,n.useState)({LastModifyByUser:{FirstName:"You"}}),d=e=>{switch(e){case"pdf":case"xls":case"xlsx":return"other";default:return"image"}},p=e=>{i(e),s({[d(e.Type)]:!0})};return n.createElement("div",{className:"comments"},n.createElement(mt,{acceptFiles:["xls","xlsx"],value:m,onZoomAttachment:p,onSave:t=>a(e.Id,t)}),(0,u.orderBy)(null===e||void 0===e?void 0:e.Comments,"LastModifyDate","desc").map(a=>n.createElement(mt,{key:a.Id,acceptFiles:["xls","xlsx"],value:a,canEdit:t===a.LastModifyBy,onZoomAttachment:p,onSave:t=>l(e.Id,a.Id,t),onDelete:()=>r(e.Id,a.Id)})),n.createElement(We,{show:o.image,hide:()=>s({image:!1}),type:null===c||void 0===c?void 0:c.Type,src:null===c||void 0===c?void 0:c.Url}),n.createElement(Ke,{show:o.other,hide:()=>s({other:!1}),path:null===c||void 0===c?void 0:c.Url,title:null===c||void 0===c?void 0:c.Name,type:null===c||void 0===c?void 0:c.Type}))};var ut=a(74350);const pt=(0,r.connect)(({requestDetails:e,dictionaries:t,user:a})=>{var l;return{isFetching:e.isFetching,request:e.request,fetchingControlSheet:null===t||void 0===t||null===(l=t.inProgress)||void 0===l?void 0:l.controlSheet,unitSystems:null===t||void 0===t?void 0:t.unitSystems,saveInProgress:e.saveInProgress||e.changeStatusInProgress,canAlwaysEdit:a.canAlwaysEdit,userName:a.id}},e=>({requestDetailsActions:(0,o.bindActionCreators)(l,e),dictionariesActions:(0,o.bindActionCreators)(ut,e)}))(({isFetching:e,request:t,fetchingControlSheet:a,unitSystems:l,saveInProgress:r,userName:o,canAlwaysEdit:c,match:i,dictionariesActions:m,requestDetailsActions:d})=>{const{updateTitle:u}=(0,y.A)("Request Details"),{isReadonly:b,isAdmin:C}=(0,g.A)(),{modalVisible:w,toggleModalVisible:N}=(0,f.A)(["notUnique"]),[S,A]=(0,n.useState)(!0),P=i.path.split("/")[1];(0,n.useEffect)(()=>(d.fetchItem(i.params.requestId),()=>{d.clearCurrentRequest()}),[]);(0,n.useEffect)(()=>{t&&(u(t.Name),(()=>{if(c)return void A(!0);let e=!b;var a,l;if(e)switch(null===t||void 0===t||null===(a=t.Status)||void 0===a||null===(l=a.Name)||void 0===l?void 0:l.toLowerCase()){case"approval needed":case"approved":e=!C}A(e)})())},[t,c]),(0,n.useEffect)(()=>{m.fetchUnitSystemDict()},[]);const I=(0,n.useRef)({generalInfo:null,soForm:null,carton:null});return n.createElement("div",{className:"page-content"},n.createElement(ne,{onSave:()=>{const e=Object.values(I.current).find(e=>!!e);e&&e.canSave()&&e.save()}}),n.createElement("div",{className:"requst-details"},n.createElement(v,{redirectToFirstTab:i.isExact},n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/GeneralInfo`,label:"General Info"},n.createElement(h.A,{ref:e=>I.current.generalInfo=e,page:P,request:t,disabled:!S,onFetchPoNumbers:m.fetchPoNumbers,onFetchStyles:m.fetchStyles,onSave:async e=>{const{status:t}=await d.updateItem(i.params.requestId,e);"duplicate"===t&&N({notUnique:!0})}})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/ControlSheet`,label:"Control Sheet"},n.createElement(ot,{request:t,onFetch:m.fetchControlSheet})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/SOForm`,label:"SO Form"},n.createElement(nt,{ref:e=>I.current.soForm=e,page:P,request:t,disabled:!S,onSave:d.updateSoForm})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/Components`,label:"Components"},n.createElement(at,{request:t,disabled:!S,groupTypeName:"Components",onAddAttachments:d.addAttachments,onDeleteAttachment:d.deleteAttachment,onUpdateComment:d.updateGroupComment})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/Garment`,label:"Garment"},n.createElement(at,{request:t,disabled:!S,groupTypeName:"Garments",onAddAttachments:d.addAttachments,onDeleteAttachment:d.deleteAttachment,onUpdateComment:d.updateGroupComment})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/Packing`,label:"Packing"},n.createElement(at,{request:t,disabled:!S,groupTypeName:"Packings",onAddAttachments:d.addAttachments,onDeleteAttachment:d.deleteAttachment,onUpdateComment:d.updateGroupComment})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/ClosedCarton`,label:"Closed Carton"},n.createElement(at,{request:t,disabled:!S,groupTypeName:"ClosedCartons",onAddAttachments:d.addAttachments,onDeleteAttachment:d.deleteAttachment,onUpdateComment:d.updateGroupComment},n.createElement(de,{ref:e=>I.current.carton=e,page:P,request:t,disabled:!S,unitSystems:l,onSave:d.saveCarton,onSetUnitSystem:d.setUnitSystem,onSetQuantityPerCarton:d.setQuantityPerCarton}))),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/AdditionalPhotos`,label:"Additional Photos"},n.createElement(at,{request:t,disabled:!S,groupTypeName:"AdditionalPhotos",onAddAttachments:d.addAttachments,onDeleteAttachment:d.deleteAttachment,onUpdateComment:d.updateGroupComment})),n.createElement(p,{path:`/${P}/${i.params.requestId}/Details/Comments`,label:"Comments"},n.createElement(dt,{request:t,userName:o,onAdd:d.addComment,onUpdate:d.updateComment,onDelete:d.deleteComment}))),n.createElement(s.A,{isVisible:e||a||r})),n.createElement(E.A,{show:w.notUnique,hide:()=>N({notUnique:!1})}))}),vt=pt},67233:()=>{},68117:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var l=a(65043),n=a(53536);const r=["tab","home","end","delete","arrowleft","arrowright","backspace","0","1","2","3","4","5","6","7","8","9"],o=({value:e,autoFocus:t,unit:a,onChange:o,onBlur:s=()=>{}})=>{const[c,i]=(0,l.useState)(e);return(0,l.useEffect)(()=>{i((0,n.isString)(e)?e:`${e}`)},[e]),l.createElement("div",{className:"double-input"},l.createElement("input",{type:"text",autoFocus:t,value:c,onKeyDown:e=>{c.includes(".")&&(r.includes(e.key.toLowerCase())||e.preventDefault()),[...r,"."].includes(e.key.toLowerCase())||e.preventDefault(),"enter"===e.key.toLowerCase()&&s()},onChange:e=>o(e.target.value),onBlur:s}),a&&l.createElement("div",{className:"unit"},a))}},84573:(e,t,a)=>{"use strict";a.d(t,{S:()=>o,s:()=>r});var l=a(75058),n=a(22129);const r=(e,t)=>(console.error(t),e((0,l.error)((0,n.A)("Error during fetch items.")))),o=(e,t)=>(console.error(t),e((0,l.error)((0,n.A)(t))))}}]);
//# sourceMappingURL=940.73e6379c.chunk.js.map