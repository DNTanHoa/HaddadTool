(globalThis.webpackChunkphoto8=globalThis.webpackChunkphoto8||[]).push([[626],{6297:(e,t,a)=>{"use strict";a.d(t,{d:()=>o});var l=a(75058),n=a(5318),r=a(22129);const o=()=>({showError:e=>{n.Ay.dispatch((0,l.error)((0,r.A)(e.toString())))},showSuccess:e=>{n.Ay.dispatch((0,l.success)((0,r.A)(e)))}})},12759:(e,t,a)=>{var l=a(99421),n=a(45652),r=a(9096),o=a(66487),s=a(54052);e.exports=function(e,t,a){var c=s(e)?l:o,i=arguments.length<3;return c(e,r(t,4),a,i,n)}},16335:(e,t,a)=>{"use strict";a.d(t,{FL:()=>c,N:()=>s,X7:()=>u,cg:()=>m,yN:()=>d,zL:()=>i});var l=a(40854),n=a.n(l),r=a(73936);const o=async(e,t,a)=>{const l=await n().post(`${r.U.backendUrl}${e}?query=${t.trim()}`,{Page:a,PageSize:50});return{Code:l.data.Code,Result:l.data.Result}},s=(e,t)=>o("/Common/Factory/Search",e,t),c=(e,t)=>o("/Common/Reference/Search",e,t),i=(e,t)=>o("/Common/Color/Search",e,t),d=(e,t)=>o("/Common/Label/Search",e,t),m=(e,t)=>o("/Common/Customer/Search",e,t),u=(e,t)=>o("/Common/Country/Search",e,t)},36073:(e,t,a)=>{"use strict";a.d(t,{$b:()=>c,ku:()=>i,o6:()=>d,x6:()=>m});var l=a(72450),n=a.n(l),r=a(40854),o=a.n(r),s=a(62911);a(73936);function c(e,t="",a=512){const l=atob(e),n=[];for(let r=0;r<l.length;r+=a){const e=l.slice(r,r+a),t=new Array(e.length);for(let a=0;a<e.length;a+=1)t[a]=e.charCodeAt(a);const o=new Uint8Array(t);n.push(o)}return new Blob(n,{type:t})}function i(e){return e instanceof Blob?new Promise(t=>{const a=new FileReader;a.onload=()=>{t(function(e){let t="";const a=new Uint8Array(e),l=a.byteLength;for(let n=0;n<l;n+=1)t+=String.fromCharCode(a[n]);return window.btoa(t)}(a.result))},a.readAsArrayBuffer(e)}):null}const d=(e,t,a)=>{const l=c(t,s.pt.getMimeType(a));n().saveAs(l,`${e}.${s.pt.getExtension(a)}`)},m=e=>new Promise(async(t,a)=>{try{const a=await o().get(e,{responseType:"application/pdf"});t({src:`data:application/pdf;base64,${a.data}#toolbar=0`})}catch(l){a(l)}})},36359:(e,t,a)=>{"use strict";a.r(t),a.d(t,{exportToExcel:()=>h,fetchHistory:()=>E,fetchItems:()=>p});var l=a(40854),n=a.n(l),r=a(18527),o=a(86883),s=a(84573),c=a(47515),i=a(23133),d=a(73936),m=a(36073),u=a(62911);const p=(e,t,a)=>async l=>{try{const s=(0,r.v4)();l({type:o.QY,payload:{fetchId:s,pageParams:e,sortParams:t,filterParams:a}});const m=await n().post(`${d.U.backendUrl}/Requests/Search`,{...e,...(0,c.Wl)(t),...(0,i.Y)(a)});if(200===m.data.Code)return l({type:o.a4,payload:{fetchId:s,items:m.data.Result.Items,total:m.data.Result.Total}})}catch(m){return l({type:o.Px}),(0,s.s)(l,res.data.Error)}},h=(e,t)=>async()=>{try{const a=await n().post(`${d.U.backendUrl}/Requests/ExportToExcel`,{...(0,c.Wl)(e),...(0,i.Y)(t)});if(200===a.data.Code)return(0,m.o6)(a.data.Result.Name,a.data.Result.Content,u.pt.XLSX);throw new Error(a.data.Error)}catch(a){throw a}},E=e=>async t=>{try{t({type:o.oo});const a=await n().post(`${d.U.backendUrl}/Requests/${e}/History`);if(200===a.data.Code)return t({type:o.EL}),a.data.Result}catch(a){throw t({type:o.Hf}),a}}},40545:(e,t,a)=>{"use strict";a.d(t,{In:()=>o,fV:()=>s,Ay:()=>c});var l=a(65043),n=a(98139),r=a.n(n);const o=({className:e,children:t})=>l.createElement("div",{className:r()({"header-content-left":!0,[e]:!!e})},t),s=({className:e,children:t})=>l.createElement("div",{className:r()({"header-content-right":!0,[e]:!!e})},t),c=({className:e,children:t,isVisible:a})=>a?l.createElement("div",{className:r()({"header-content-flex-wrapper":!0,[e]:!!e})},t):null},45012:(e,t,a)=>{"use strict";a.d(t,{Y:()=>l});const l=(e,t)=>e?[e.FirstName,e.LastName].join(" "):t},50732:(e,t,a)=>{"use strict";a.d(t,{q:()=>r});var l=a(65043),n=a(73936);const r=(e=(e=>null===n.U||void 0===n.U||null===(e=n.U.seasonYear)||void 0===e?void 0:e.startYear)(),t=(e=>null===n.U||void 0===n.U||null===(e=n.U.seasonYear)||void 0===e?void 0:e.range)())=>{const a=["Spring","Summer","Fall","Holiday"];let r=e||(new Date).getFullYear();const[o,s]=(0,l.useState)([]),[c,i]=(0,l.useState)([]);return(0,l.useEffect)(()=>{var e;const l=(null===n.U||void 0===n.U||null===(e=n.U.seasonYear)||void 0===e?void 0:e.predefinedValues)||[];for(let n=r;n<=r+t;n++)a.forEach(e=>l.push(`${e} ${n}`));s(l),i(l.map(e=>({Id:e,Name:e})))},[]),[o,c]}},51404:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var l=a(65043),n=a(92127);const r=({clearButtonTooltip:e="Clear",onClear:t})=>l.createElement("div",{className:"field-clear-button",onClick:t,title:e},l.createElement(n.g,{icon:["far","times-circle"]}))},60952:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var l=a(65043),n=a(83810);const r=({placeholder:e,field:t,onSearch:a,selected:r,keyField:o="Id",searchField:s="Name",onSelect:c,children:i})=>l.createElement("div",{className:"searchable-dropdown-filter"},l.createElement(n.Ay,{placeholder:e,onSearch:a,keyField:o,itemsToIgnore:r.map(e=>({[o]:parseInt(e.code,10),[s]:e.name})),onSelect:e=>c(!0,{code:e[o],name:e[s]},t)},i))},62911:(e,t,a)=>{"use strict";a.d(t,{pt:()=>n});const l=JSON.parse('{"pdf":"application/pdf","ppt":"application/vnd.ms-powerpoint","xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}'),n={PDF:"PDF",PPT:"PPTX",XLSX:"XLSX",getExtension:e=>e.toLowerCase(),getMimeType:e=>l[e]}},66487:e=>{e.exports=function(e,t,a,l,n){return n(e,function(e,n,r){a=l?(l=!1,e):t(a,e,n,r)}),a}},72450:function(e,t,a){var l,n,r;n=[],void 0===(r="function"===typeof(l=function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function l(e,t,a){var l=new XMLHttpRequest;l.open("GET",e),l.responseType="blob",l.onload=function(){c(l.response,t,a)},l.onerror=function(){console.error("could not download file")},l.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(l){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,t,a){var s=o.URL||o.webkitURL,c=document.createElement("a");t=t||e.name||"download",c.download=t,c.rel="noopener","string"==typeof e?(c.href=e,c.origin===location.origin?r(c):n(c.href)?l(e,t,a):r(c,c.target="_blank")):(c.href=s.createObjectURL(e),setTimeout(function(){s.revokeObjectURL(c.href)},4e4),setTimeout(function(){r(c)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,o){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,o),a);else if(n(e))l(e,a,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){r(s)})}}:function(e,t,a,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return l(e,t,a);var r="application/octet-stream"===e.type,c=/constructor/i.test(o.HTMLElement)||o.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||r&&c||s)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},d.readAsDataURL(e)}else{var m=o.URL||o.webkitURL,u=m.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){m.revokeObjectURL(u)},4e4)}});o.saveAs=c.saveAs=c,e.exports=c})?l.apply(t,n):l)||(e.exports=r)},83810:(e,t,a)=>{"use strict";a.d(t,{RZ:()=>m,St:()=>p,Ay:()=>u});var l=a(65043),n=a(98139),r=a.n(n),o=a(44238),s=a(14992),c=a(51404);const i=({showClearButton:e=!0,onClear:t,children:a})=>l.createElement("div",{className:"selected-item"},l.createElement("div",{className:"value"},a,e&&l.createElement(c.A,{clearButtonTooltip:"Remove",onClear:t}))),d=({selected:e,itemsToIgnore:t=[],placeholder:a,onSearch:n,keyField:c="Id",inGroup:d=!1,disabled:m=!1,onSelect:u,onBlur:p,children:h})=>{const E=(0,l.useRef)(null),f=(0,l.useRef)(null),[v,g]=(0,l.useState)(""),[y,w]=(0,l.useState)(1),[N,C]=(0,l.useState)(0),[b,A]=(0,l.useState)(!1),[S,F]=(0,l.useState)(!1),[D,T]=(0,l.useState)([]),_=t.map(e=>e[c]),k=async e=>{A(!0);const t=await n(v,e),{Code:a,Result:l}=t;200===a&&(1===e?(T(l.Items),1===l.Items.length?(u(l.Items[0]),g(""),d?(T([]),C(0)):(F(!1),f.current.blur())):C(l.Total)):T([...D,...l.Items])),A(!1)},L=()=>{T([]),C(0),F(!0),k(y)};return(0,l.useEffect)(()=>{const e=e=>{E&&E.current&&!E.current.contains(e.target)&&F(!1)};return document.addEventListener("mousedown",t=>e(t)),()=>{document.removeEventListener("mousedown",t=>e(t))}},[]),l.createElement("div",{ref:E,className:r()({"searchable-dropdown":!0,disabled:m})},l.createElement("input",{ref:f,className:r()({selected:!!e}),type:"text",value:e?"":v,placeholder:a,onChange:e=>{g(e.target.value),w(1)},onKeyDown:e=>{!b&&v.length>0&&"enter"===e.key.toLowerCase()&&(e.preventDefault(),L()),"escape"===e.key.toLowerCase()&&(F(!1),e.target.blur()),b||"tab"!==e.key.toLowerCase()||v.length>0&&L()},onFocus:()=>{!e&&D.length>0&&F(!0)},onPaste:e=>{const t=(e.clipboardData||window.clipboardData).getData("text");g(t.trim()),e.preventDefault()},onBlur:p}),e&&l.createElement(i,{showClearButton:!m&&!d,onClear:()=>{g(""),u(null),T([]),C(0),f.current.focus()}},h(e)),!e&&!m&&l.createElement("div",{className:"actions"},l.createElement("div",{className:r()({search:!0,disabled:!v}),onClick:L},l.createElement("img",{src:s,alt:"",title:"Search"}))),S&&l.createElement("div",{className:"list",style:{width:f.current?`${f.current.offsetWidth}px`:"auto"}},(_.length?D.filter(e=>!_.includes(e[c])):D).map(e=>l.createElement("div",{key:e[c],className:"item",onClick:()=>{g(""),u(e),F(!1),T([]),C(0),d&&f.current.focus()}},h(e))),!b&&D.length<N&&l.createElement("div",{className:"load-more",onClick:()=>(()=>{const e=y+1;w(e),k(e)})()},"Load more..."),b&&l.createElement("div",{className:"spinner-wrapper"},l.createElement(o.A,{isVisible:!0,size:25}))))},m=({selectedItems:e=[],placeholder:t,onSearch:a,labelField:n,keyField:o,disabled:s,onBlur:c,onAdd:m,onDelete:u,children:p})=>{const[h,E]=(0,l.useState)(null);return l.createElement("div",{className:r()({"searchable-dropdown-group":!0,disabled:s})},!s&&l.createElement(d,{disabled:s,selected:h,placeholder:t,labelField:n,keyField:o,itemsToIgnore:e,onSearch:a,inGroup:!0,onSelect:t=>{t&&!e.some(e=>e[o]===t[o])&&(m(t),E(null))},onBlur:c},e=>p(e)),l.createElement("div",{className:"selected-items"},e.map(e=>l.createElement(i,{key:e[o],showClearButton:!s,onClear:()=>u(e)},e[n]))))},u=d,p=e=>new Promise(t=>{t({Code:200,Result:{Items:e}})})},85626:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Se});var l=a(65043),n=a(62582),r=a(97508),o=a(77048),s=a(37687),c=a(70508),i=a(13355),d=a(35772),m=a(24168);const u=({date:e,format:t="MMM D, GGGG"})=>e?l.createElement("div",null,(0,m.format)(e,t)):null,p=u;var h=a(75787),E=a(45012),f=a(36359),v=a(20398),g=a(91688),y=a(42065),w=a(40545),N=a(6297),C=a(71719);const b=(0,r.connect)(({requests:e})=>({listState:e}),e=>({requestsActions:(0,o.bindActionCreators)(f,e)}))(({listState:e,requestsActions:t})=>{const a=(0,g.W6)(),[n,r]=(0,l.useState)(!1),{showError:o}=(0,N.d)(),{isReadonly:s,isApprover:c}=(0,C.A)();return l.createElement(y.A,{className:"requests-header",userInfoClassName:"header-user-info__small",small:!0},l.createElement(w.Ay,{isVisible:!0},l.createElement(w.In,null,l.createElement("p",{className:"default-header__title"},"Requests"),l.createElement(d.A,{isVisible:!s&&!c,type:"primary",onClick:()=>a.push("/Create")},"Create New"),l.createElement(d.A,{type:"primary",inProgress:n,curtain:!0,onClick:async a=>{a.target.blur();try{r(!0),await t.exportToExcel(e.sortParams,e.filterParams)}catch(l){o(l)}finally{r(!1)}}},"Export to Excel")),l.createElement(w.fV,null)))});var A=a(16335),S=a(54699),F=a(50732),D=a(51850),T=a(58839),_=a(36422),k=a.n(_),L=a(36932),P=a(92265),V=a(78299),M=a(86263),R=a.n(M),O=a(22519),x=a(9777),I=a(36721),U=a(98139),$=a.n(U);const B=l.forwardRef(({children:e,...t},a)=>l.createElement("button",Object.assign({ref:a,type:"button",className:"btn--empty dropdown__toggle"},t),e)),q=l.forwardRef(({children:e,style:t,placement:a,className:n},r)=>l.createElement("ul",{ref:r,className:`dropdown__list ${n}`,style:t,"data-placement":a},e)),j=({children:e,inactive:t,onClick:a,className:n})=>{const r=$()({[n]:!0,"dropdown__list-item":!0,"dropdown__list-item--inactive":t});return l.createElement("li",{className:r},l.createElement("button",{type:"button",className:"btn--empty list-item__button",onClick:e=>a(e)},e))};function G({children:e,className:t,innerRef:a,dataCy:n,...r}){return l.createElement("div",Object.assign({"data-cy":n,className:`dropdown ${t}`,ref:a},r),e)}G.Toggle=B,G.List=q,G.Item=j,G.Separator=()=>l.createElement("li",{className:"dropdown__list-separator"}),j.defaultProps={inactive:!1,className:""};const H=G;var K=a(35005);const Y=({isOpen:e})=>l.createElement(L.A,{glyph:"arrow-right",className:"filter__icon",width:10,height:10,style:{transform:e?"rotate(270deg)":"rotate(90deg)",marginLeft:"5px"}}),W=({className:e,btnClassName:t,label:a,getTitle:n,children:r})=>l.createElement(R(),null,l.createElement(O.Ay,null,l.createElement(V.Ay,null,({isOpen:o,getToggleButtonProps:s,getRootProps:c})=>l.createElement(H,Object.assign({},c({refKey:"innerRef"}),{className:`filters-${a.toLowerCase().replace("/","").replace(/\s/g,"-")} \n                                ${e}`}),l.createElement(x.A,null,({ref:e})=>l.createElement(H.Toggle,Object.assign({ref:e},s(),{className:t}),(e=>l.createElement(l.Fragment,null,n(),l.createElement(Y,{isOpen:e})))(o))),l.createElement(K.A,{isVisible:o},l.createElement(I.Ay,{placement:"bottom-start",modifiers:{preventOverflow:{enabled:!0}}},({style:e,placement:t,ref:a})=>l.createElement(H.List,{ref:a,style:e,placement:t},r({isOpen:o})))))))),X=({className:e,label:t,minDate:a,maxDate:n,dateFrom:r,dateTo:o,showFullLabel:s,onDateChange:c,onClear:i})=>l.createElement(W,{className:`filter-date-dropdown ${e||""}`,btnClassName:"filter-date-btn",label:t,getTitle:()=>{const e=(()=>{let e="";return r&&(e=`from: ${k()(r,"MM/DD/YYYY")}`),o&&(e=`${e} to ${k()(o,"MM/DD/YYYY")}`),e.trim()})();return l.createElement("span",{className:"filter__labels"},t,":"," ",l.createElement("span",{className:r||o?"filter__choices":"filter__choices--all"},r||o?s?e:`${e.substr(0,4)}...`:"All"))}},()=>l.createElement("div",{className:"datepickers"},l.createElement(P.A,{min:a,max:n,value:r,onChange:e=>c("from",e)}),l.createElement("span",{className:"datepickers__separator"},"to"),l.createElement(P.A,{min:a,max:n,value:o,onChange:e=>c("to",e)}),l.createElement(L.A,{className:"filter-modal__clear-btn",width:25,height:25,glyph:"icon-clear",fillColor:"#333",onClick:i})));var z=a(60952),J=a(12759),Q=a.n(J);const Z=({children:e,handleClick:t})=>l.createElement("button",{className:"close-button btn--empty",onClick:t,type:"button"},e),ee=({selected:e,handleClick:t})=>l.createElement(K.A,{isVisible:e.length>0},l.createElement("div",{className:"filter__info"},l.createElement("div",null,l.createElement("strong",null,e.length," ")," selected"),l.createElement(Z,{handleClick:t},l.createElement(L.A,{glyph:"icon-clear",width:16,height:16})))),te=e=>{const[t,a]=(0,l.useState)(""),n=t=>e.itemKey?e.itemKey(t):t[e.idField||"Id"],r=e=>{a(e.target.value)},o=t=>{e.handleNewFilter(t.target.checked,{code:t.target.name,name:t.target.dataset.label},e.field)},s=()=>{e.handleClearSingleFilter(e.field)};return l.createElement(W,{className:`${e.selected.length>0?"filter_id__dropdown":"filter_id__dropdown__empty"} ${e.className?e.className:""}`,btnClassName:"filter_id__dropdown__btn",label:e.label,getTitle:()=>l.createElement(l.Fragment,null,l.createElement("span",{className:"filter__labels"},e.label,":"," ",l.createElement("span",{className:e.selected.length>0?"filter__choices":"filter__choices--all"},(()=>{const t=Q()(e.selected,(e,t)=>[...e,t.name],[]);return e.selected.length>0?e.showFullLabel?t.join(", "):e.maxItemsInLabel>0?`${t.slice(0,e.maxItemsInLabel).join(", ")}...`:`${t.join(", ").substr(0,4)}...`:"All"})())))},({isOpen:a})=>l.createElement(l.Fragment,null,l.createElement(K.A,{isVisible:e.searchable},l.createElement("div",null,l.createElement("input",{type:"text",value:t,onChange:r,onClick:e=>{e.stopPropagation()},className:"form-control filter__search-input"}))),e.list.filter(e=>e.Name.toLowerCase().includes(t.toLowerCase())).map(t=>{return l.createElement("li",{className:"item",key:n(t)},l.createElement("input",{id:n(t),type:"checkbox",name:n(t),checked:(a=n(t),Q()(e.selected,(e,t)=>[...e,t.code],[]).indexOf(String(a))>-1),"data-label":t[e.labelKey||"Name"],onChange:o}),l.createElement("label",{htmlFor:n(t)},e.itemComponent&&l.createElement(l.Fragment,null,e.itemComponent(t)),!e.itemComponent&&l.createElement(l.Fragment,null,t[e.labelKey||"Name"])));var a}),l.createElement(ee,{selected:e.selected,isOpen:a,handleClick:s})))};te.defaultProps={searchable:!1,withImg:!1,list:[]};const ae=te,le=({items:e,selected:t,idField:a="Id",nameField:n="Name",onSelect:r})=>l.createElement("div",{className:"radio-filter"},l.createElement("div",{className:$()({option:!0,selected:!t}),onClick:()=>r(null)},"All"),null===e||void 0===e?void 0:e.map(e=>l.createElement("div",{key:e[a],className:$()({option:!0,selected:(null===t||void 0===t?void 0:t[a])===e[a]}),onClick:()=>r({...e,code:e[a]})},e[n]))),ne=({value:e})=>l.createElement("div",{className:`status ${e.toLowerCase()}`},e),re=(0,r.connect)(({requests:e,dictionaries:t})=>({requests:e,dictionaries:t}),e=>({requestsActions:(0,o.bindActionCreators)(f,e)}))(({requests:e,dictionaries:t,requestsActions:a})=>{const n=new Date(2015,0,1),r=new Date(2099,11,31),[o,s]=(0,F.q)(),{pageParams:c,sortParams:i,filterParams:d}=e,m=()=>({createdDateFrom:(0,T.D5)(d.CreatedDate.from),createdDateTo:(0,T.D5)(d.CreatedDate.to)}),[u,p]=(0,l.useState)(m());(0,l.useEffect)(()=>{p(m())},[JSON.stringify(d.CreatedDate)]);const h=(e,t)=>{p(e),t({...d,CreatedDate:{from:e.createdDateFrom,to:e.createdDateTo}})},{isFactory:E,isAdmin:f,isMultiApprover:g}=(0,C.A)();return l.createElement(S.A,{module:"requests",className:"requests-filters",filtersPlaceholder:"Requests",filterParams:d,sortParams:i,defaultFilterParams:(0,v.n9)(),searchPlaceholder:"Name / Approved by",searchFieldName:"Text",showSelectedFilters:!0,selectedFiltersLabelsMap:{Text:"Search:","Customer.Account":"Customer:","Factory.Code":"Factory:","Factory.Country":"Country:",Label:"Label:",Season:"Season / Year:",CreatedDate:"Created"},showFilterCode:!0,onFiltersChange:(e,t=null)=>{a.fetchItems(c,t||i,e)},onClearMoreFilters:()=>{p({CreatedDate:{from:null,to:null}})}},({onSingleValueFilterChange:e,onMultiValueFilterChange:a,onClearMutliValueFilter:o,onMoreFiltersChange:c})=>l.createElement(l.Fragment,null,l.createElement(z.A,{placeholder:"Customer",field:"Customer.Account",selected:d["Customer.Account"],keyField:"Account",onSearch:A.cg,onSelect:a},e=>l.createElement("span",null,e.Account," - ",e.Name)),!E&&l.createElement(l.Fragment,null,l.createElement(D.A.Separator,null),l.createElement(z.A,{placeholder:"Factory",field:"Factory.Code",selected:d["Factory.Code"],keyField:"Code",onSearch:A.N,onSelect:a},e=>l.createElement("span",null,e.Code," / ",e.Name)),l.createElement(D.A.Separator,null),l.createElement(z.A,{placeholder:"Country",keyField:"Name",field:"Factory.Country",selected:d["Factory.Country"],onSearch:A.X7,onSelect:a},e=>l.createElement("span",null,e.Name))),l.createElement(D.A.Separator,null),l.createElement(z.A,{placeholder:"Label",field:"Label",selected:d.Label,keyField:"Id",onSearch:A.yN,onSelect:a},e=>l.createElement("span",null,e.Name)),l.createElement(D.A.Separator,null),l.createElement(X,{label:"Created",minDate:n,maxDate:r,dateFrom:u.createdDateFrom,dateTo:u.createdDateTo,onDateChange:(e,t)=>{h(((e,t)=>({...u,[e]:t}))("from"===e?"createdDateFrom":"createdDateTo",t),c)},onClear:()=>{h({...u,createdDateFrom:null,createdDateTo:null},c)}}),l.createElement(D.A.Separator,null),l.createElement(ae,{label:"Status",field:"StatusId",list:t.statuses,selected:d.StatusId,itemComponent:e=>l.createElement(ne,{value:e.Name}),handleNewFilter:a,handleClearSingleFilter:o}),l.createElement(D.A.Separator,null),l.createElement(ae,{searchable:!0,label:"Season / Year",field:"Season",list:s,selected:d.Season,handleNewFilter:a,handleClearSingleFilter:o}),(E||f||g)&&l.createElement(l.Fragment,null,l.createElement(D.A.Separator,null),l.createElement(le,{selected:d.TypeId,items:t.requestTypes,onSelect:t=>e(t,"TypeId")}))))}),oe=({value:e})=>l.createElement("div",{style:{width:"max-content",padding:"0 0.75rem",backgroundColor:"#aaa",color:"white",borderRadius:"4px"}},e);var se=a(21525),ce=a.n(se),ie=a(72287),de=a(27030),me=a(52295),ue=a(36296),pe=a(53536);const he=(e,t={codeField:"Code",nameField:"Name"})=>{const{codeField:a,nameField:n}=t,[r,o]=(0,l.useState)({});(0,l.useEffect)(()=>{if(e)return Array.isArray(e)?e.some(e=>!!e.children)?o((0,pe.keyBy)(e.reduce((e,t)=>[...e,...t.children],[]),a)):o((0,pe.keyBy)(e,a)):o((0,pe.keyBy)(Object.values(e),a))},[e]);return[e=>r[e]?r[e][n]:e,t=>{var l;return null===(l=e.find(e=>{var a;return(null===(a=e[n])||void 0===a?void 0:a.toLowerCase())===t.toLowerCase()}))||void 0===l?void 0:l[a]},r]};var Ee=a(92127);const fe=({item:e})=>l.createElement("div",{className:"history-event-header"},l.createElement("div",{className:"date"},l.createElement(Ee.g,{icon:["fas","calendar-alt"]}),l.createElement("div",null,(0,m.format)(e.ModifyDate,"MMM D, GGGG HH:mm"))),l.createElement("div",{className:"user"},l.createElement("div",null,(0,E.Y)(e.ModifyByUser,e.ModifyBy)),l.createElement("div",{className:"avatar"},l.createElement(Ee.g,{icon:["fas","user"]})))),ve=({code:e,groupType:t,groupName:a,attachments:n})=>{const r=$()({files:!0,add:"ADD_ATTACHMENT"===e,remove:"DELETE_ATTACHMENT"===e});return l.createElement("div",{className:"history-event-attachment"},l.createElement("div",null,"ADD_ATTACHMENT"===e?"Added":"Deleted"),l.createElement("div",null,"attachment",(null===n||void 0===n?void 0:n.length)>1?"s":""),l.createElement("div",null,"on ",l.createElement("b",null,t,"/",a)),l.createElement("div",{className:r},n.join(", ")))},ge=({addLabel:e,updateLabel:t,valueName:a,oldValue:n,newValue:r,groupType:o,groupName:s})=>{const c=!n;return l.createElement("div",{className:"history-event-single-value"},(!!e||!!t)&&l.createElement("div",null,c?e:t," ",a),!!o&&!!s&&l.createElement("div",null,"on ",l.createElement("b",null,o,"/",s)),l.createElement("div",{className:"change"},!c&&l.createElement(l.Fragment,null,l.createElement("div",{className:"old"},n),l.createElement(Ee.g,{icon:["fas","long-arrow-alt-right"]})),l.createElement("div",{className:"new"},r)))};var ye=a(88458),we=a.n(ye);const Ne=({changeName:e,oldValue:t,newValue:a,fieldsMap:n={},fieldParser:r={}})=>{const[o,s]=(0,l.useState)({}),c=(e,t)=>r[t]?r[t](e):e;return(0,l.useEffect)(()=>{s(Object.keys(a).reduce((e,l)=>{var n,r;return Array.isArray(a[l])?we()(a[l],t[l]).length>0&&(e[l]={old:null!==(n=t[l])&&void 0!==n&&n.length?t[l].map(e=>c(e,l)).join("; "):null,new:null!==(r=a[l])&&void 0!==r&&r.length?a[l].map(e=>c(e,l)).join("; "):null}):""!==a[l]&&a[l]!==t[l]&&(e[l]={old:c(t[l],l),new:c(a[l],l)}),e},{}))},[t,a]),l.createElement("div",{className:"history-event-difference"},!!e&&l.createElement("div",null,"Updated ",l.createElement("b",null,e)),Object.keys(o).map(e=>{var t,a;return l.createElement("div",{className:"field",key:e},l.createElement("div",{className:"field-name"},n[e]||e,":"),l.createElement(ge,{oldValue:null===(t=o[e])||void 0===t?void 0:t.old,newValue:null===(a=o[e])||void 0===a?void 0:a.new}))}))},Ce=({oldValue:e,newValue:t,fieldsMap:a})=>{const[n,r]=(0,l.useState)({}),o=e=>e.reduce((e,t)=>(e[t.Po]=t,delete e[t.Po].Id,delete e[t.Po].Po,e),{});return(0,l.useEffect)(()=>{r((()=>{const a=o(e),l=o(t);return Object.keys(l).reduce((e,t)=>(e[t]={old:a[t],new:l[t]},e),{})})())},[e,t]),l.createElement("div",{className:"history-event-cartons"},Object.keys(n).map(e=>{var t,r;return l.createElement("div",{key:e,className:"carton"},l.createElement("div",null,n[e].old?"Updated":"Added"," closed carton data for ",l.createElement("b",null,e)),l.createElement(Ne,{oldValue:(null===(t=n[e])||void 0===t?void 0:t.old)||{},newValue:(null===(r=n[e])||void 0===r?void 0:r.new)||{},fieldsMap:a}))}))},be=({code:e,value:t})=>l.createElement("div",{className:"history-event-add-delete-comment"},"ADD_COMMENT"===e?"Add":"Delete"," ",l.createElement("b",null,"Comment"),l.createElement("div",{className:$()({["ADD_COMMENT"===e?"add":"delete"]:!0})},!!t.Text&&l.createElement("div",null,"Text: ",t.Text),!!t.Attachments.length&&l.createElement("div",null,"Attachments: ",t.Attachments.join(", ")))),Ae=({show:e,hide:t,id:a,dictionaries:n,onFetch:r})=>{const[o,s]=(0,l.useState)(!1),[c,i]=(0,l.useState)([]),[d]=he(null===n||void 0===n?void 0:n.groupTypes,{codeField:"Id",nameField:"Name"}),[u]=he(null===n||void 0===n?void 0:n.groupNames,{codeField:"Id",nameField:"Name"}),{showError:p}=(0,N.d)(),h=e=>(null===e||void 0===e?void 0:e.startsWith("{"))||(null===e||void 0===e?void 0:e.startsWith("["));return(0,l.useEffect)(()=>{a?(async()=>{try{s(!0);const e=await r(a);i(e.map(e=>({...e,OldValue:h(e.OldValue)?JSON.parse(e.OldValue):e.OldValue,NewValue:h(e.NewValue)?JSON.parse(e.NewValue):e.NewValue})))}catch(e){p(e)}finally{s(!1)}})():i([])},[a]),l.createElement(ie.A,{show:e,onHide:t,className:"history-modal"},l.createElement(de.A,{title:"History",handleToggle:t}),l.createElement(ce(),null,l.createElement("div",{className:"history-table"},l.createElement(ue.A,{isVisible:o,size:100}),!o&&!c.length&&l.createElement("div",{className:"no-history"},"There is no history for this request."),c.map(e=>l.createElement("div",{key:e.Id,className:"history-row"},l.createElement(fe,{item:e}),l.createElement("div",{className:"details"},(e=>{switch(e.EventType.Code){case"ADD_ATTACHMENT":case"DELETE_ATTACHMENT":return l.createElement(ve,{code:e.EventType.Code,groupType:d(e.NewValue.TypeId),groupName:u(e.NewValue.NameId),attachments:e.NewValue.Attachments||[e.NewValue.Attachment]});case"UPDATE_GROUP_COMMENT":return l.createElement(ge,{addLabel:"Added",updateLabel:"Updated",valueName:"group comment",groupType:d(e.NewValue.TypeId),groupName:u(e.NewValue.NameId),oldValue:e.OldValue.Comment,newValue:e.NewValue.Comment});case"CHANGE_STATUS":return l.createElement(ge,{updateLabel:"Changed",valueName:"status",oldValue:e.OldValue,newValue:e.NewValue});case"UPDATE_SO_FORM":return l.createElement(ge,{addLabel:"Set",valueName:"SO Form",oldValue:e.OldValue,newValue:e.NewValue});case"UPDATE_GENERAL_INFO":return l.createElement(Ne,{changeName:"General Info",oldValue:e.OldValue,newValue:e.NewValue,fieldsMap:{AllPos:"All POs",ShipDates:"Ship Dates",FactoryCode:"Factory",CustomerId:"Customer",ReferenceNumber:"Reference #"},fieldParser:{Labels:e=>""===e?"BLANK":e,ShipDates:e=>(0,m.format)(new Date(e),"MMM D, GGGG")}});case"UPDATE_CARTONS":return l.createElement(Ce,{oldValue:e.OldValue,newValue:e.NewValue,fieldsMap:{NetWeight:"Net Weight",GrossWeight:"Gross Weight"}});case"ADD_COMMENT":case"DELETE_COMMENT":return l.createElement(be,{code:e.EventType.Code,value:e.NewValue});case"UPDATE_COMMENT":return l.createElement(Ne,{changeName:"Comment",oldValue:e.OldValue,newValue:e.NewValue});default:return l.createElement(l.Fragment,null,"Created request")}})(e)))))),l.createElement(me.A,{canBeApproved:!1,labelCancel:"close",handleCancel:t}))},Se=(0,r.connect)(({requests:e,dictionaries:t})=>({listState:e,dictionaries:t}),e=>({requestActions:(0,o.bindActionCreators)(f,e)}))(({listState:e,dictionaries:t,requestActions:a})=>{(0,h.A)("All Requests");const[r,o]=(0,l.useState)(null);return l.createElement(l.Fragment,null,l.createElement(b,null),l.createElement(s.A,{module:"requests",listState:e,listActions:a,fetchDictionaries:e=>Promise.all([e.fetchStatusDict(),e.fetchGroupTypeDict(),e.fetchGroupNameDict(),e.fetchRequestTypeDict()])},({isDictionariesFetching:s,setListRef:m,changePage:u,changePageSize:h,changeSort:f})=>l.createElement(l.Fragment,null,l.createElement(re,null),l.createElement("div",{className:"requests",ref:e=>m(e)},l.createElement(c.Ay,{id:"request-list"},({setRef:t,getDataWrapperHeight:a})=>l.createElement(l.Fragment,null,l.createElement(c.Do,{ref:e=>t("header",e),config:v.Kr,sort:e.sortParams,defaultSort:e.defaultSortParams,onSortChanged:f,canRestoreSort:!0}),l.createElement(c.yf,{ref:e=>t("data",e),data:e.items,isDataAvailable:!s&&!e.isFetching,getRowClassName:e=>{var t,a,l,n;return"approval needed"===(null===(t=e.Status)||void 0===t||null===(a=t.Name)||void 0===a?void 0:a.toLowerCase())&&"approved"===(null===(l=e.PreviousStatus)||void 0===l||null===(n=l.Name)||void 0===n?void 0:n.toLowerCase())?"from-approved-to-approval-needed":""},getDataWrapperHeight:a,noDataMessage:"There is no items."},({row:e})=>l.createElement(l.Fragment,null,l.createElement(i.$g,{width:6,value:""}),l.createElement(i.$g,{width:v.Kr.width.Name,value:e.Name,left:!0}),l.createElement(i.$g,{width:v.Kr.width.Customer,value:e.Customer?`${e.Customer.Account} - ${e.Customer.Name}`:"",left:!0}),l.createElement(i.ul,{className:"cell-po-numbers",width:v.Kr.width.PoNumber},e.AllPos.map(e=>l.createElement("div",{key:e.Po},e.Po))),l.createElement(i.ul,{className:"cell-list-of-data",width:v.Kr.width.Label},e.Labels.map(e=>l.createElement(oe,{key:e.Name,value:e.Name}))),l.createElement(i.$g,{width:v.Kr.width["Factory.Code"],value:e.Factory.Code,left:!0}),l.createElement(i.$g,{width:v.Kr.width["Factory.Country"],value:e.Factory.Country,left:!0}),l.createElement(i.ul,{width:v.Kr.width["Status.Name"],className:"cell-text cell-text-left"},l.createElement(ne,{value:e.Status.Name})),l.createElement(i.$g,{width:v.Kr.width.Season,value:e.Season,left:!0}),l.createElement(i.ul,{className:"cell-list-of-data",width:v.Kr.width.ShipDate},e.ShipDates.map(e=>l.createElement(p,{key:e,date:e}))),l.createElement(i.gc,{width:v.Kr.width.CreatedDate,value:e.CreatedDate,left:!0}),l.createElement(i.$g,{className:"username",width:v.Kr.width.CreatedBy,value:(0,E.Y)(e.CreatedByUser,e.CreatedBy),left:!0}),l.createElement(i.gc,{width:v.Kr.width.LastModifyDate,value:e.LastModifyDate,left:!0}),l.createElement(i.$g,{className:"username",width:v.Kr.width.ApprovedBy,value:(0,E.Y)(e.ApprovedByUser,e.ApprovedBy),left:!0}),l.createElement(i.ul,{className:"cell-options",width:v.Kr.width.__options},l.createElement(n.N_,{className:"btn btn-primary",to:`/Requests/${e.Id}/Details`,title:"Details"},"Details"),l.createElement(d.A,{type:"primary",onClick:t=>{t.target.blur(),o(e.Id)}},"History")))),l.createElement(c.Yw,{ref:e=>t("pagination",e),rowsPerPage:e.pageParams.PageSize,page:e.pageParams.Page,total:e.total,disabled:e.isFetching,handleRowsSelect:h,handlePageSelect:u})))),l.createElement(Ae,{show:!!r,hide:()=>o(null),id:r,dictionaries:t,onFetch:a.fetchHistory}))))})},92265:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var l=a(65043),n=a(18672),r=a.n(n),o=a(98139),s=a.n(o),c=a(51404);const i=({min:e,max:t,value:a,touched:n,error:o,onChange:i,onClear:d,placeholder:m,onBlur:u,className:p,views:h,disabled:E})=>{const f=s()({datepicker:!0,[p]:p,"date-time-picker--error":n&&o});return l.createElement("div",{className:f},l.createElement("div",{className:"datepicker-content"},l.createElement(r(),{min:e,max:t,value:a,onChange:i,onBlur:u,views:h||["month","year","decade"],placeholder:m,disabled:E}),!!a&&!E&&l.createElement(c.A,{onClear:()=>{d?d():i(null)}})),n&&o&&l.createElement("span",{className:"date-time-picker__error"},o))};i.defaultProps={min:Date(1900,0,1),max:Date(2099,11,31),value:null};const d=i},99421:e=>{e.exports=function(e,t,a,l){var n=-1,r=null==e?0:e.length;for(l&&r&&(a=e[++n]);++n<r;)a=t(a,e[n],n,e);return a}}}]);
//# sourceMappingURL=626.8469b5f1.chunk.js.map